"use strict";var re=Object.create;var A=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var se=Object.getPrototypeOf,ie=Object.prototype.hasOwnProperty;var oe=(e,t)=>{for(var r in t)A(e,r,{get:t[r],enumerable:!0})},z=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ae(t))!ie.call(e,o)&&o!==r&&A(e,o,{get:()=>t[o],enumerable:!(i=ne(t,o))||i.enumerable});return e};var R=(e,t,r)=>(r=e!=null?re(se(e)):{},z(t||!e||!e.__esModule?A(r,"default",{value:e,enumerable:!0}):r,e)),ce=e=>z(A({},"__esModule",{value:!0}),e);var de={};oe(de,{default:()=>J});module.exports=ce(de);var d=require("@raycast/api");var s=R(require("react")),a=require("@raycast/api");var V=Object.prototype.hasOwnProperty;function _(e,t){var r,i;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((i=e.length)===t.length)for(;i--&&_(e[i],t[i]););return i===-1}if(!r||typeof e=="object"){i=0;for(r in e)if(V.call(e,r)&&++i&&!V.call(t,r)||!(r in t)||!_(e[r],t[r]))return!1;return Object.keys(t).length===i}}return e!==e&&t!==t}var y=R(require("node:fs")),T=R(require("node:path"));var j=require("react/jsx-runtime");function le(e){let t=(0,s.useRef)(e),r=(0,s.useRef)(0);return _(e,t.current)||(t.current=e,r.current+=1),(0,s.useMemo)(()=>t.current,[r.current])}function p(e){let t=(0,s.useRef)(e);return t.current=e,t}function ue(e,t){let r=e instanceof Error?e.message:String(e);return(0,a.showToast)({style:a.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??N(e),secondaryAction:t?.primaryAction?N(e):void 0})}var N=e=>{let t=!0,r="[Extension Name]...",i="";try{let u=JSON.parse((0,y.readFileSync)((0,T.join)(a.environment.assetsPath,"..","package.json"),"utf8"));r=`[${u.title}]...`,i=`https://raycast.com/${u.owner||u.author}/${u.name}`,(!u.owner||u.access==="public")&&(t=!1)}catch{}let o=a.environment.isDevelopment||t,l=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:o?"Copy Logs":"Report Error",onAction(u){u.hide(),o?a.Clipboard.copy(l):(0,a.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(i)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${l}
\`\`\`
`)}`)}}};function F(e,t,r){let i=(0,s.useRef)(0),[o,l]=(0,s.useState)({isLoading:!0}),u=p(e),v=p(r?.abortable),w=p(t||[]),P=p(r?.onError),S=p(r?.onData),L=p(r?.onWillExecute),M=p(r?.failureToastOptions),W=p(o.data),C=(0,s.useRef)(null),f=(0,s.useRef)({page:0}),I=(0,s.useRef)(!1),O=(0,s.useRef)(!0),D=(0,s.useRef)(50),b=(0,s.useCallback)(()=>(v.current&&(v.current.current?.abort(),v.current.current=new AbortController),++i.current),[v]),g=(0,s.useCallback)((...h)=>{let c=b();L.current?.(h),l(n=>({...n,isLoading:!0}));let k=fe(u.current)(...h);function x(n){return n.name=="AbortError"||c===i.current&&(P.current?P.current(n):a.environment.launchType!==a.LaunchType.Background&&ue(n,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction($){$.hide(),C.current?.(...w.current||[])}},...M.current}),l({error:n,isLoading:!1})),n}return typeof k=="function"?(I.current=!0,k(f.current).then(({data:n,hasMore:$,cursor:ee})=>(c===i.current&&(f.current&&(f.current.cursor=ee,f.current.lastItem=n?.[n.length-1]),S.current&&S.current(n,f.current),$&&(D.current=n.length),O.current=$,l(te=>f.current.page===0?{data:n,isLoading:!1}:{data:(te.data||[])?.concat(n),isLoading:!1})),n),n=>(O.current=!1,x(n)))):(I.current=!1,k.then(n=>(c===i.current&&(S.current&&S.current(n),l({data:n,isLoading:!1})),n),x))},[S,P,w,u,l,C,L,f,M,b]);C.current=g;let E=(0,s.useCallback)(()=>{f.current={page:0};let h=w.current||[];return g(...h)},[g,w]),Z=(0,s.useCallback)(async(h,c)=>{let k;try{if(c?.optimisticUpdate){b(),typeof c?.rollbackOnError!="function"&&c?.rollbackOnError!==!1&&(k=structuredClone(W.current?.value));let x=c.optimisticUpdate;l(n=>({...n,data:x(n.data)}))}return await h}catch(x){if(typeof c?.rollbackOnError=="function"){let n=c.rollbackOnError;l($=>({...$,data:n($.data)}))}else c?.optimisticUpdate&&c?.rollbackOnError!==!1&&l(n=>({...n,data:k}));throw x}finally{c?.shouldRevalidateAfter!==!1&&(a.environment.launchType===a.LaunchType.Background||a.environment.commandMode==="menu-bar"?await E():E())}},[E,W,l,b]),q=(0,s.useCallback)(()=>{f.current.page+=1;let h=w.current||[];g(...h)},[f,w,g]);(0,s.useEffect)(()=>{f.current={page:0},r?.execute!==!1?g(...t||[]):b()},[le([t,r?.execute,g]),v,f]),(0,s.useEffect)(()=>()=>{b()},[b]);let Y=r?.execute!==!1?o.isLoading:!1,X={...o,isLoading:Y},Q=I.current?{pageSize:D.current,hasMore:O.current,onLoadMore:q}:void 0;return{...X,revalidate:E,mutate:Z,pagination:Q}}function fe(e){return e===Promise.all||e===Promise.race||e===Promise.resolve||e===Promise.reject?e.bind(Promise):e}var B=require("node:fs"),K=require("node:fs/promises"),G=require("node:os"),U=R(require("node:path")),H=async()=>{let e=(0,G.homedir)(),t=U.default.join(e,".ssh");return(await(0,K.readdir)(t)).filter(o=>o.endsWith(".pub")).map(o=>({title:o,path:U.default.join(t,o),readFile:()=>(0,B.readFileSync)(U.default.join(t,o),"utf8")}))};var m=require("react/jsx-runtime");function J(){let{data:e=[],isLoading:t}=F(H,[],{failureToastOptions:{title:"Failed to load SSH keys"}});return(0,m.jsx)(d.List,{isLoading:t,children:(0,m.jsx)(d.List.Section,{title:"SSH Keys",subtitle:e.length.toString(),children:e.map(r=>(0,m.jsx)(d.List.Item,{icon:d.Icon.Key,title:r.title,subtitle:r.path,actions:(0,m.jsxs)(d.ActionPanel,{children:[(0,m.jsx)(d.Action.CopyToClipboard,{title:"Copy SSH Key",content:r.readFile()}),(0,m.jsx)(d.Action.ShowInFinder,{path:r.path})]})},r.title))})})}
